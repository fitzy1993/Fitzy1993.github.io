<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wedding Guest List Manager</title>
    <link rel="stylesheet" href="css/styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <div class="container">
        <!-- Setup Phase -->
        <div id="setup-screen" class="screen active">
            <div class="card">
                <h1>üíï Wedding Guest List Manager</h1>
                <p class="subtitle">Let's create your dream guest list together</p>

                <!-- Step: Partner 1 Name -->
                <div class="question-step active" id="setup-step-partner1">
                    <h2>What's your name?</h2>
                    <input type="text" id="partner1-name" placeholder="Enter your name" class="text-input" autocomplete="off">
                    <button class="big-button" id="setup-partner1-next">Next ‚û°Ô∏è</button>
                </div>

                <!-- Step: Partner 1 Photo -->
                <div class="question-step" id="setup-step-partner1-photo">
                    <h2 id="partner1-photo-question">Upload your photo</h2>
                    <div class="photo-upload-container">
                        <img id="partner1-photo-preview" class="photo-preview" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='120' height='120'%3E%3Crect fill='%23ffb7c5' width='120' height='120'/%3E%3Ctext x='50%25' y='50%25' dominant-baseline='middle' text-anchor='middle' font-size='40' fill='white'%3Eüë§%3C/text%3E%3C/svg%3E" alt="Partner 1 photo">
                        <br>
                        <label for="partner1-photo-input" class="upload-button">Choose Photo üì∏</label>
                        <input type="file" id="partner1-photo-input" accept="image/*" style="display:none;">
                    </div>
                    <button class="big-button" id="setup-partner1-photo-next">Next ‚û°Ô∏è</button>
                    <button class="secondary-button" id="setup-partner1-photo-skip">Skip for Now</button>
                </div>

                <!-- Step: Partner 2 Name or Invite -->
                <div class="question-step" id="setup-step-partner2-choice">
                    <h2>Is your partner here with you?</h2>
                    <button class="big-button choice-button" id="setup-partner2-here">Yes, they're here! üíë</button>
                    <button class="big-button choice-button" id="setup-partner2-invite">No, invite them later üì≤</button>
                </div>

                <!-- Step: Partner 2 Name -->
                <div class="question-step" id="setup-step-partner2">
                    <h2>What's your partner's name?</h2>
                    <input type="text" id="partner2-name" placeholder="Enter their name" class="text-input" autocomplete="off">
                    <button class="big-button" id="setup-partner2-next">Next ‚û°Ô∏è</button>
                </div>

                <!-- Step: Partner 2 Photo -->
                <div class="question-step" id="setup-step-partner2-photo">
                    <h2 id="partner2-photo-question">Upload their photo</h2>
                    <div class="photo-upload-container">
                        <img id="partner2-photo-preview" class="photo-preview" src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='120' height='120'%3E%3Crect fill='%23ffb7c5' width='120' height='120'/%3E%3Ctext x='50%25' y='50%25' dominant-baseline='middle' text-anchor='middle' font-size='40' fill='white'%3Eüë§%3C/text%3E%3C/svg%3E" alt="Partner 2 photo">
                        <br>
                        <label for="partner2-photo-input" class="upload-button">Choose Photo üì∏</label>
                        <input type="file" id="partner2-photo-input" accept="image/*" style="display:none;">
                    </div>
                    <button class="big-button" id="setup-partner2-photo-next">Next ‚û°Ô∏è</button>
                    <button class="secondary-button" id="setup-partner2-photo-skip">Skip for Now</button>
                </div>

                <!-- Step: Invite Code Display -->
                <div class="question-step" id="setup-step-invite">
                    <h2>üì≤ Send this code to your partner</h2>
                    <p class="subtitle">They can use it to join your wedding planning!</p>
                    <div class="invite-code" id="invite-code-display">LOADING...</div>
                    <p style="text-align: center; color: var(--gray); font-size: 0.9em;">
                        Share this code or URL with your partner
                    </p>
                    <button class="big-button" id="setup-invite-continue">Continue Solo for Now</button>
                </div>

                <!-- Step: Cost Per Guest -->
                <div class="question-step" id="setup-step-cost">
                    <h2>What's the cost per guest?</h2>
                    <p class="subtitle">This helps calculate your total budget</p>
                    <div style="position: relative;">
                        <span style="position: absolute; left: 15px; top: 15px; font-size: 1.2em; color: var(--gray);">$</span>
                        <input type="number" id="cost-per-guest" placeholder="150" class="text-input" min="1" style="padding-left: 35px;">
                    </div>
                    <button class="big-button" id="setup-cost-next">Next ‚û°Ô∏è</button>
                </div>

                <!-- Step: Floor Budget -->
                <div class="question-step" id="setup-step-floor">
                    <h2>Minimum number of guests?</h2>
                    <p class="subtitle">The smallest guest list you'd be comfortable with</p>
                    <input type="number" id="floor-budget" placeholder="50" class="text-input" min="1">
                    <button class="big-button" id="setup-floor-next">Next ‚û°Ô∏è</button>
                </div>

                <!-- Step: Middle Budget -->
                <div class="question-step" id="setup-step-middle">
                    <h2>Ideal number of guests?</h2>
                    <p class="subtitle">Your target sweet spot</p>
                    <input type="number" id="middle-budget" placeholder="100" class="text-input" min="1">
                    <button class="big-button" id="setup-middle-next">Next ‚û°Ô∏è</button>
                </div>

                <!-- Step: Max Budget -->
                <div class="question-step" id="setup-step-max">
                    <h2>Maximum number of guests?</h2>
                    <p class="subtitle">The absolute hard ceiling</p>
                    <input type="number" id="max-budget" placeholder="150" class="text-input" min="1">
                    <button class="big-button" id="setup-max-next">All Done! üéâ</button>
                </div>
            </div>
        </div>

        <!-- Partner Selection -->
        <div id="partner-select-screen" class="screen">
            <div class="card">
                <h1>Who's adding guests?</h1>
                <p class="subtitle">Select your name to start adding guests independently</p>
                <button class="big-button partner-button" id="select-partner1"></button>
                <button class="big-button partner-button" id="select-partner2"></button>
                <button class="secondary-button" id="view-progress">View Progress</button>
            </div>
        </div>

        <!-- Stage 1: Brain Dump -->
        <div id="braindump-screen" class="screen">
            <div class="card">
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
                <p class="partner-label" id="current-partner"></p>
                <button class="secondary-button" id="bulk-import-button" style="margin-bottom: 20px;">üìã Import Existing List</button>

                <!-- Question: Name -->
                <div class="question-step active" id="step-name">
                    <h2>Who's someone you'd want at your wedding?</h2>
                    <input type="text" id="guest-name" placeholder="Enter their name" class="text-input" autocomplete="off">
                    <button class="big-button" id="name-next">Next ‚û°Ô∏è</button>
                </div>

                <!-- Question: Relationship -->
                <div class="question-step" id="step-relationship">
                    <h2 id="relationship-question"></h2>
                    <button class="big-button choice-button" data-value="friend">Friend</button>
                    <button class="big-button choice-button" data-value="family">Family</button>
                    <button class="big-button choice-button" data-value="coworker">Coworker</button>
                    <button class="big-button choice-button" data-value="extended-family">Extended Family</button>
                    <button class="big-button choice-button" data-value="parents-friend">Parent's Friend</button>
                </div>

                <!-- Question: Age Range -->
                <div class="question-step" id="step-age">
                    <h2 id="age-question"></h2>
                    <button class="big-button choice-button" data-value="20s-30s">20s - 30s</button>
                    <button class="big-button choice-button" data-value="30s-40s">30s - 40s</button>
                    <button class="big-button choice-button" data-value="40s-50s">40s - 50s</button>
                    <button class="big-button choice-button" data-value="50+">50+</button>
                </div>

                <!-- Question: Note -->
                <div class="question-step" id="step-note">
                    <h2 id="note-question"></h2>
                    <textarea id="guest-note" placeholder="Add a note (optional)" class="text-input"></textarea>
                    <button class="big-button" id="note-next">Next ‚û°Ô∏è</button>
                    <button class="secondary-button" id="note-skip">Skip</button>
                </div>

                <!-- Question: Add More -->
                <div class="question-step" id="step-addmore">
                    <div class="success-checkmark">‚úÖ</div>
                    <h2>Added!</h2>
                    <div class="guest-count-badge" id="current-guest-count">1 guest added!</div>
                    <p class="guest-summary" id="guest-summary"></p>
                    <button class="big-button" id="add-another">Add Another Guest üéâ</button>
                    <button class="secondary-button" id="done-adding">I'm Done</button>
                </div>
            </div>
        </div>

        <!-- Progress View -->
        <div id="progress-screen" class="screen">
            <div class="card">
                <h1>Progress Update</h1>
                <div class="stats-container">
                    <div class="stat-box">
                        <div class="stat-number" id="partner1-count">0</div>
                        <div class="stat-label" id="partner1-label"></div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-number" id="partner2-count">0</div>
                        <div class="stat-label" id="partner2-label"></div>
                    </div>
                </div>
                <p class="subtitle">Both partners need to finish adding guests before moving to the next stage.</p>
                <button class="big-button" id="back-to-partner-select">Back</button>
                <button class="big-button" id="continue-to-duplicates" style="display:none;">Find Duplicates üîç</button>
            </div>
        </div>

        <!-- Stage 2: Duplicate Detection -->
        <div id="duplicate-screen" class="screen">
            <div class="card">
                <h1>üîç Duplicate Detection</h1>
                <p class="subtitle">We found some potential duplicates. Are these the same person?</p>

                <div id="duplicate-container"></div>

                <div id="no-duplicates" style="display:none;">
                    <p>‚úÖ No duplicates found! Moving to rating stage...</p>
                </div>

                <button class="big-button" id="finish-duplicates" style="display:none;">Continue to Rating</button>
            </div>
        </div>

        <!-- Stage 3: Rating -->
        <div id="rating-screen" class="screen">
            <div class="card">
                <div class="progress-bar">
                    <div class="progress-fill" id="rating-progress-fill"></div>
                </div>
                <p class="partner-label" id="rating-partner"></p>
                <p class="rating-counter" id="rating-counter"></p>

                <!-- Question: Should Invite -->
                <div class="rating-step active" id="rating-step-invite">
                    <h2 id="rating-guest-name"></h2>
                    <p class="guest-detail" id="rating-guest-detail"></p>
                    <p class="rating-question">Should they be invited?</p>
                    <button class="big-button choice-button" data-value="yes">‚úÖ Yes</button>
                    <button class="big-button choice-button" data-value="maybe">ü§î Maybe</button>
                    <button class="big-button choice-button" data-value="no">‚ùå No</button>
                </div>

                <!-- Question: Will Attend -->
                <div class="rating-step" id="rating-step-attend">
                    <h2 id="rating-guest-name2"></h2>
                    <p class="rating-question">Will they actually come?</p>
                    <button class="big-button choice-button" data-value="definitely">Definitely (95%)</button>
                    <button class="big-button choice-button" data-value="probably">Probably (75%)</button>
                    <button class="big-button choice-button" data-value="maybe">Maybe (50%)</button>
                    <button class="big-button choice-button" data-value="unlikely">Unlikely (25%)</button>
                </div>

                <!-- Question: Champion -->
                <div class="rating-step" id="rating-step-champion">
                    <h2 id="rating-guest-name3"></h2>
                    <p class="rating-question">Who really wants them there?</p>
                    <button class="big-button choice-button" data-value="me">You</button>
                    <button class="big-button choice-button" data-value="partner">Your Partner</button>
                    <button class="big-button choice-button" data-value="both">Both of Us</button>
                    <button class="big-button choice-button" data-value="your-parents">Your Parents</button>
                    <button class="big-button choice-button" data-value="partner-parents">Partner's Parents</button>
                </div>

                <!-- Question: Priority -->
                <div class="rating-step" id="rating-step-priority">
                    <h2 id="rating-guest-name4"></h2>
                    <p class="rating-question">How important is it that they're there?</p>
                    <button class="big-button choice-button" data-value="must-have" style="background: linear-gradient(135deg, #ff9aa2 0%, #ffb7b2 100%);">‚ù§Ô∏è Must Have</button>
                    <button class="big-button choice-button" data-value="really-want" style="background: linear-gradient(135deg, #ffc9de 0%, #ffd4e5 100%);">üíñ Really Want</button>
                    <button class="big-button choice-button" data-value="nice-to-have" style="background: linear-gradient(135deg, #ffe0eb 0%, #fff0f3 100%); color: #4a4a4a;">üíï Nice to Have</button>
                    <button class="big-button choice-button" data-value="flexible" style="background: linear-gradient(135deg, #f5f5f5 0%, #e0e0e0 100%); color: #4a4a4a;">ü§ç Flexible</button>
                </div>
            </div>
        </div>

        <!-- Rating Selection -->
        <div id="rating-select-screen" class="screen">
            <div class="card">
                <h1>Time to Rate!</h1>
                <p class="subtitle">Each partner needs to rate all guests independently. You won't see each other's ratings until you're both done.</p>
                <button class="big-button partner-button" id="rating-select-partner1"></button>
                <button class="big-button partner-button" id="rating-select-partner2"></button>
                <button class="secondary-button" id="rating-view-progress">View Rating Progress</button>
            </div>
        </div>

        <!-- Rating Progress View -->
        <div id="rating-progress-screen" class="screen">
            <div class="card">
                <h1>Rating Progress</h1>
                <div class="stats-container">
                    <div class="stat-box">
                        <div class="stat-number" id="rating-partner1-count">0</div>
                        <div class="stat-label" id="rating-partner1-label"></div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-number" id="rating-partner2-count">0</div>
                        <div class="stat-label" id="rating-partner2-label"></div>
                    </div>
                </div>
                <p class="subtitle">Both partners need to finish rating before the reveal.</p>
                <button class="big-button" id="back-to-rating-select">Back</button>
                <button class="big-button" id="continue-to-reveal" style="display:none;">See The Reveal! üé≠</button>
            </div>
        </div>

        <!-- Stage 4: The Reveal -->
        <div id="reveal-screen" class="screen">
            <div class="card wide">
                <h1>üé≠ The Reveal</h1>
                <p class="subtitle">Here's how your ratings compare!</p>

                <div class="bucket">
                    <h2>‚úÖ Both Said Yes</h2>
                    <div class="guest-grid" id="bucket-yes"></div>
                </div>

                <div class="bucket">
                    <h2>‚ö†Ô∏è Need to Discuss</h2>
                    <p class="bucket-subtitle">One said yes, the other said maybe or no</p>
                    <div class="guest-grid" id="bucket-conflict"></div>
                </div>

                <div class="bucket">
                    <h2>‚ùå Both Said No</h2>
                    <div class="guest-grid" id="bucket-no"></div>
                </div>

                <button class="big-button" id="view-dashboard">View Dashboard üìä</button>
                <button class="secondary-button" id="view-cut-list" style="display:none;">‚úÇÔ∏è Need to Cut Guests?</button>
            </div>
        </div>

        <!-- Cut List Screen -->
        <div id="cutlist-screen" class="screen">
            <div class="card wide">
                <h1>‚úÇÔ∏è Cut List Helper</h1>
                <p class="subtitle">You're over budget! Here are smart suggestions on who to cut.</p>

                <div class="budget-alert">
                    <div class="alert-row">
                        <span>Current "Yes" list:</span>
                        <strong id="cutlist-current">0</strong>
                    </div>
                    <div class="alert-row">
                        <span>Your maximum:</span>
                        <strong id="cutlist-max">0</strong>
                    </div>
                    <div class="alert-row over">
                        <span>Need to cut:</span>
                        <strong id="cutlist-need">0</strong>
                    </div>
                </div>

                <h3 style="margin-top: 30px;">Suggested Cuts (lowest priority first):</h3>
                <div id="cut-suggestions"></div>

                <button class="big-button" id="cutlist-to-dashboard">View Updated Dashboard üìä</button>
                <button class="secondary-button" id="cutlist-back">Back to Reveal</button>
            </div>
        </div>

        <!-- Bulk Import Modal -->
        <div id="bulk-import-modal" class="modal">
            <div class="modal-content">
                <h2>üìã Import Your Guest List</h2>
                <p class="subtitle">Paste your list below - one guest per line</p>
                <p style="font-size: 0.9em; color: var(--gray); margin-bottom: 15px;">
                    Format: Name (or Name, Relationship, Age Range, Notes)<br>
                    Example: John Smith, friend, 30s-40s, college buddy
                </p>
                <textarea id="bulk-import-text" placeholder="John Smith&#10;Jane Doe, family, 50+&#10;Bob Johnson, coworker, 20s-30s, works in IT" class="text-input" style="min-height: 200px;"></textarea>
                <button class="big-button" id="bulk-import-process">Import Guests üéâ</button>
                <button class="secondary-button" id="bulk-import-cancel">Cancel</button>
                <div id="bulk-import-preview" style="margin-top: 20px; display: none;">
                    <h3>Preview:</h3>
                    <div id="bulk-import-preview-list"></div>
                </div>
            </div>
        </div>

        <!-- Stage 5: Dashboard -->
        <div id="dashboard-screen" class="screen">
            <div class="card wide">
                <h1>üìä Dashboard</h1>

                <div class="budget-summary">
                    <h3>Budget Overview</h3>
                    <div class="budget-bars">
                        <div class="budget-bar">
                            <div class="budget-label">Current List</div>
                            <div class="budget-value" id="current-guests">0</div>
                        </div>
                        <div class="budget-bar">
                            <div class="budget-label">Expected Attendance</div>
                            <div class="budget-value" id="expected-attendance">0</div>
                        </div>
                        <div class="budget-bar">
                            <div class="budget-label">Floor</div>
                            <div class="budget-value" id="floor-value">0</div>
                        </div>
                        <div class="budget-bar">
                            <div class="budget-label">Middle Zone</div>
                            <div class="budget-value" id="middle-value">0</div>
                        </div>
                        <div class="budget-bar">
                            <div class="budget-label">Max</div>
                            <div class="budget-value" id="max-value">0</div>
                        </div>
                    </div>
                    <div class="cost-display">
                        <strong>Estimated Cost:</strong> <span id="estimated-cost">$0</span>
                    </div>
                </div>

                <div class="charts-grid">
                    <div class="chart-container">
                        <h3>Relationship Categories</h3>
                        <canvas id="relationship-chart"></canvas>
                    </div>

                    <div class="chart-container">
                        <h3>Age Distribution</h3>
                        <canvas id="age-chart"></canvas>
                    </div>

                    <div class="chart-container">
                        <h3>Who's Championing</h3>
                        <canvas id="champion-chart"></canvas>
                    </div>

                    <div class="chart-container">
                        <h3>Attendance Probability</h3>
                        <canvas id="attendance-chart"></canvas>
                    </div>
                </div>

                <button class="secondary-button" id="back-to-reveal">Back to Reveal</button>
                <button class="secondary-button" id="start-over">Start Over</button>
            </div>
        </div>
    </div>

    <script src="js/storage.js"></script>
    <script src="js/fuzzy-match.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
